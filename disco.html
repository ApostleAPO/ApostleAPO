<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Party â€” One Page</title>
  <style>
    :root{--bg:#0b0b12;--accent:#ff3de6}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:radial-gradient(circle at 20% 20%, #1b1b2f 0%, #0b0b12 40%), #000;color:#fff;overflow:hidden}
    .container{position:relative;height:100vh;width:100vw;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:20px;box-sizing:border-box}

    header{width:100%;max-width:980px;display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:8px}
    h1{font-size:clamp(20px,4vw,34px);margin:0}
    .controls{display:flex;gap:8px;align-items:center}
    input[type="url"]{padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.08);background:rgba(255,255,255,0.02);color:inherit;width:360px;min-width:140px}
    button{background:linear-gradient(90deg,#ff9a00,#ff3de6);border:none;padding:10px 14px;border-radius:10px;color:#111;font-weight:700;cursor:pointer}
    button:active{transform:translateY(1px)}
    .hint{opacity:0.7;font-size:13px}

    /* disco lights */
    .lights{position:absolute;inset:0;pointer-events:none;mix-blend-mode:screen}
    .beam{position:absolute;border-radius:50%;filter:blur(30px);opacity:0.9;width:500px;height:500px;transform-origin:center}
    .beam.b1{background:radial-gradient(circle,#ff3de6 0%,transparent 50%);top:-120px;left:-120px;animation:spin 12s linear infinite}
    .beam.b2{background:radial-gradient(circle,#00eaff 0%,transparent 50%);top:-120px;right:-120px;animation:spin 10s linear reverse infinite}
    .beam.b3{background:radial-gradient(circle,#ffe600 0%,transparent 50%);bottom:-150px;left:40%;animation:spin 14s linear infinite}
    @keyframes spin{from{transform:rotate(0deg) translateZ(0)}to{transform:rotate(360deg) translateZ(0)}}

    /* dance floor */
    .floor{position:relative;z-index:3;margin-top:20px;width:100%;max-width:1200px;height:64vh;border-radius:14px;overflow:hidden;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));box-shadow:0 8px 40px rgba(0,0,0,0.6)}
    .dancefloor-grid{position:absolute;inset:0;display:grid;grid-template-columns:repeat(8,1fr);grid-auto-rows:1fr;gap:2px}
    .cell{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);opacity:0.7}
    /* animated tiles */
    .cell:nth-child(4n){animation:tile 1.4s ease-in-out infinite}
    .cell:nth-child(6n){animation:tile 1.1s ease-in-out infinite}
    @keyframes tile{0%{transform:scale(1)}50%{transform:scale(1.12)}100%{transform:scale(1)}}

    /* cats */
    .cats{position:relative;z-index:4;display:flex;gap:20px;flex-wrap:wrap;align-items:flex-end;justify-content:center;padding:24px}
    .cat{width:160px;height:160px;border-radius:14px;display:flex;align-items:center;justify-content:center;overflow:hidden;background:rgba(255,255,255,0.02);backdrop-filter:blur(4px);box-shadow:0 6px 18px rgba(0,0,0,0.6)}
    .cat img{width:100%;height:100%;object-fit:cover;animation:dance 0.9s steps(8) infinite}
    @keyframes dance{0%{transform:translateY(0)}50%{transform:translateY(-10px)}100%{transform:translateY(0)}}

    /* party info */
    .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;z-index:5}
    .panel{background:linear-gradient(180deg, rgba(0,0,0,0.55), rgba(0,0,0,0.7));padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);display:flex;gap:12px;align-items:center}
    .small{font-size:13px;opacity:0.9}

    /* YouTube frame area */
    .video-wrap{position:absolute;right:18px;bottom:18px;width:320px;height:180px;border-radius:10px;overflow:hidden;border:1px solid rgba(255,255,255,0.06);z-index:6;background:#000}
    .video-wrap iframe{width:100%;height:100%;display:block}

    /* responsive */
    @media (max-width:720px){
      .cat{width:110px;height:110px}
      .video-wrap{width:220px;height:140px}
      input[type=url]{width:180px}
    }

    footer{position:fixed;left:12px;bottom:12px;z-index:8;opacity:0.8;font-size:12px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Party â€” Disco cats</h1>
      <div class="controls">
        <input id="yt-url" type="url" placeholder="Incolla link YouTube (es. https://youtu.be/ID)" />
        <button id="start">Carica & Avvia</button>
      </div>
    </header>

    <div class="floor" id="floor">
      <div class="dancefloor-grid">
        <!-- create many tiles -->
        " + Array.from({length:32}).map((_,i)=>`<div class="cell"></div>`).join('') + "
      </div>

      <div class="cats" id="cats">
        <!-- dancing cat gifs -->
        <div class="cat"><img src="https://media.giphy.com/media/JIX9t2j0ZTN9S/giphy.gif" alt="cat"/></div>
        <div class="cat"><img src="https://media.giphy.com/media/mlvseq9yvZhba/giphy.gif" alt="cat"/></div>
        <div class="cat"><img src="https://media.giphy.com/media/3oriO7A7bt1wsEP4cw/giphy.gif" alt="cat"/></div>
        <div class="cat"><img src="https://media.giphy.com/media/13CoXDiaCcCoyk/giphy.gif" alt="cat"/></div>
      </div>

      <div class="lights">
        <div class="beam b1"></div>
        <div class="beam b2"></div>
        <div class="beam b3"></div>
      </div>

      <div class="overlay" id="overlay">
        <div class="panel">
          <div>
            <div class="small">Benvenuto! Incolla il link YouTube della canzone. Quando premi <strong>Carica & Avvia</strong> verrÃ  mostrato il video e partirÃ  la festa.</div>
            <div class="hint">Hint: usa un link tipo https://youtu.be/VIDEOID o https://www.youtube.com/watch?v=VIDEOID</div>
          </div>
        </div>
      </div>

      <div class="video-wrap" id="videoWrap" aria-hidden="true" style="display:none"></div>

    </div>

    <footer>âœ¨ Built for you â€” single file HTML</footer>
  </div>

  <script>
    // small helper to generate tiles markup (we used template above but ensure it's valid in browsers)
    (function(){
      // replace the placeholder markup created in the template with real tiles in case of odd rendering
      const grid = document.querySelector('.dancefloor-grid');
      if(grid && grid.children.length === 0){
        for(let i=0;i<32;i++){const d=document.createElement('div');d.className='cell';grid.appendChild(d)}
      }
    })();

    const ytInput = document.getElementById('yt-url');
    const startBtn = document.getElementById('start');
    const overlay = document.getElementById('overlay');
    const videoWrap = document.getElementById('videoWrap');

    function extractYouTubeID(url){
      if(!url) return null;
      try{
        // common patterns
        const patterns = [
          /youtu\.be\/([\w-]{6,})/, // youtu.be/ID
          /v=([\w-]{6,})/, // v=ID
          /embed\/([\w-]{6,})/, // embed/ID
          /youtube\.com\/shorts\/([\w-]{6,})/
        ];
        for(const p of patterns){const m = url.match(p); if(m) return m[1]}
        // fallback: last path segment
        const u = new URL(url);
        const parts = u.pathname.split('/').filter(Boolean);
        if(parts.length) return parts[parts.length-1];
      }catch(e){return null}
      return null;
    }

    function startParty(videoId){
      if(!videoId) return alert('Non ho trovato un ID valido nel link. Controlla il link di YouTube.');

      // create iframe
      const src = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&controls=1&modestbranding=1`;
      videoWrap.innerHTML = '';
      const ifr = document.createElement('iframe');
      ifr.src = src;
      ifr.allow = 'autoplay; encrypted-media; fullscreen';
      ifr.title = 'YouTube Party';
      videoWrap.appendChild(ifr);
      videoWrap.style.display = 'block';
      videoWrap.setAttribute('aria-hidden','false');

      // hide overlay and flash the lights & speed up tiles
      overlay.style.display = 'none';
      document.body.classList.add('party-on');
      // animate tiles faster
      const cells = document.querySelectorAll('.cell');
      cells.forEach((c,i)=>{
        const dur = 0.7 + Math.random()*0.6;
        c.style.animation = `tile ${dur}s ease-in-out ${Math.random()*0.4}s infinite`;
      });

      // add pulsing to lights
      document.querySelectorAll('.beam').forEach((b,idx)=>{
        b.style.animationDuration = (8 + Math.random()*8) + 's';
        b.style.opacity = 0.95;
      });

      // optional little confetti of cats (spawn small emoji)
      spawnConfettiCats();
    }

    function spawnConfettiCats(){
      const container = document.querySelector('.container');
      for(let i=0;i<20;i++){
        const e = document.createElement('div');
        e.textContent = 'ðŸ˜º';
        e.style.position='absolute';
        e.style.left = Math.random()*90 + '%';
        e.style.top = '-10%';
        e.style.fontSize = (12+Math.random()*36)+'px';
        e.style.zIndex = 7;
        e.style.transition = 'transform 3s linear, top 3s linear, opacity 1s linear';
        container.appendChild(e);
        (function(el){
          requestAnimationFrame(()=>{
            el.style.top = (60+Math.random()*30)+'%';
            el.style.transform = 'rotate('+(Math.random()*720-360)+'deg)';
            el.style.opacity = '0';
          });
          setTimeout(()=>el.remove(),3200);
        })(e)
      }
    }

    startBtn.addEventListener('click', ()=>{
      const url = ytInput.value.trim();
      const id = extractYouTubeID(url);
      startParty(id);
    });

    // allow pressing Enter
    ytInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') startBtn.click(); });

    // small UX: if user hasn't entered url, focus input
    ytInput.focus();
  </script>
</body>
</html>
